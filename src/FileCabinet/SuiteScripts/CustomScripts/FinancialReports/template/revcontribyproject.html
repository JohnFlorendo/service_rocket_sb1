<!DOCTYPE html>
<html>
<head>
    <!-- css Bootstrap 3 -->
    <link rel="stylesheet" type="text/css"
          href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.0.1/css/bootstrap.min.css"/>
    <link rel="stylesheet" type="text/css"
          href="https://cdn.datatables.net/v/bs5/dt-1.11.3/af-2.3.7/b-2.0.1/date-1.1.1/fc-4.0.1/fh-3.2.0/r-2.2.9/rg-1.1.4/sc-2.0.5/sb-1.3.0/sp-1.4.0/datatables.min.css"/>
    <!-- css dataTables.bootstrap.min.css -->
    <link rel="stylesheet" type="text/css"
          href="/core/media/media.nl?id=238381&c=3688201&h=I9fWmOJP6c4gn4h0tig3Rne5Frafa_afVNW5i2GJ6mTlF0pq&_xt=.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
    <!-- css rowGroup.dataTables.min.css -->
    <link rel="stylesheet" type="text/css"
          href="/core/media/media.nl?id=237236&c=3688201&h=qMSYc8XHCBpwg90rZ8RhsDp3bXdsiA4mOlbxXzS256H_bCzw&_xt=.css">
    <!-- css FixedHeader  -->
    <link rel="stylesheet" type="text/css"
          href="https://cdn.datatables.net/fixedheader/3.2.1/css/fixedHeader.dataTables.min.css"/>
    <!-- css Datepicker  -->
    <link rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.8.0/css/bootstrap-datepicker.css"/>
    <!-- js jQuery -->
    <script type="text/javascript" language="javascript" src="https://code.jquery.com/jquery-3.5.1.js"></script>
    <!-- js Datatable  -->
    <script type="text/javascript"
            src="https://cdn.datatables.net/v/bs5/dt-1.11.3/af-2.3.7/b-2.0.1/date-1.1.1/fc-4.0.1/fh-3.2.0/r-2.2.9/rg-1.1.4/sc-2.0.5/sb-1.3.0/sp-1.4.0/datatables.min.js"></script>
    <!-- js FixedHeader  -->
    <script type="text/javascript"
            src="https://cdn.datatables.net/fixedheader/3.2.1/js/dataTables.fixedHeader.min.js"></script>
    <!-- js Buttons  -->
    <script type="text/javascript" src="https://cdn.datatables.net/buttons/2.2.2/js/dataTables.buttons.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/pdfmake.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/vfs_fonts.js"></script>
    <script type="text/javascript" src="https://cdn.datatables.net/buttons/2.2.2/js/buttons.html5.min.js"></script>
    <script type="text/javascript" src="https://cdn.datatables.net/buttons/2.2.2/js/buttons.print.min.js"></script>
    <!-- js Datatable Boostrap 3-->
    <script type="text/javascript"
            src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.0.1/js/bootstrap.bundle.min.js"></script>
    <!-- js Dates -->
    <!-- <script src="//cdn.datatables.net/1.10.19/js/jquery.dataTables.min.js"></script> -->
    <script src="//cdn.datatables.net/plug-ins/1.10.19/sorting/date-eu.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.8.0/js/bootstrap-datepicker.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.24.0/moment.min.js"></script>
    <style type="text/css">
        * {
            font-size: 14px;
            box-sizing: border-box;
        }

        ol,
        ul {
            padding-left: 0rem !important;
        }

        .text ul,
        .text ol {
            margin-left: 0px !important;
        }

        .nav {
            display: flex !important;
        }

        .tab-content {
            padding-left: 20px !important;
        }

        .table-caption {
            caption-side: top;
            width: auto;
            text-align: center
        }

        .pagination {
            display: flex !important;
            list-style: none !important;
        }

        p.truncate {
            width: 200px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            resize: horizontal;
        }

        .noaccess {
            display: block;
            margin-left: auto;
            margin-right: auto;
        }

        .loader {
            position: absolute;
            left: 50%;
            top: 50%;
            z-index: 1;
            width: 120px;
            height: 120px;
            margin: -76px 0 0 -76px;
            border: 16px solid #f3f3f3;
            border-radius: 50%;
            border-top: 16px solid #3498db;
            -webkit-animation: spin 2s linear infinite;
            animation: spin 2s linear infinite;
        }

        /* Safari */
        @-webkit-keyframes spin {
            0% {
                -webkit-transform: rotate(0deg);
            }
            100% {
                -webkit-transform: rotate(360deg);
            }
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }
            100% {
                transform: rotate(360deg);
            }
        }

        .dt-buttons {
            margin-top: 20px;
        }

        .btn-secondary {
            background-color: #eee;
            color: #555;
            padding-left: 15px;
            padding-right: 15px;
            border: 1px solid #E5E5E5;
        }
    </style>
    <script type="text/javascript">
        $(document).ready(function () {

            window.loaded = false;
            window.group = {
                'Apps': ''
            };

            $.get('/app/site/hosting/scriptlet.nl?script=1751&deploy=1&action=backend&currencyrate={{currencyrate}}', function (data) {
                    $(".loader").hide();

                    // var arrDefs = [];
                    //
                    // if(data.hide.length > 0){
                    //     arrDefs.push({
                    //         visible: false,
                    //         targets: data.hide
                    //     });
                    // }
                    //
                    // if(data.truncate.length > 0){
                    //     arrDefs.push({
                    //         render: function ( data, type, row ) {
                    //             return '<p class="truncate">' + data + '</p>';
                    //         },
                    //         targets: data.truncate
                    //     });
                    // }
                    //
                    // if(data.numeric.length > 0){
                    //     arrDefs.push({
                    //         className: 'dt-body-center',
                    //         render: DataTable.render.number(',', '.', 2, ''),
                    //         targets: data.numeric
                    //     });
                    // }
                    //
                    //
                    // if(data.link.length > 0){
                    //     arrDefs.push({
                    //         render: function ( data, type, row ) {
                    //             var arrData = data.split('+')
                    //
                    //             return '<a target="_blank" href="'+ arrData[1] + '">' + arrData[0] + '</a>';
                    //         },
                    //         targets: data.link
                    //     });
                    // }
                    //
                    // if(data.currency.length > 0){
                    //     arrDefs.push({
                    //         className: 'dt-body-right',
                    //         render: DataTable.render.number(',', '.', 2, ''),
                    //         targets: data.currency
                    //     });
                    // }

                    var arrColumnsKey = [
                        {"data": "Project"},
                        {"data": "Employee"},
                        {
                            "data": "Amountonemonthago", "title": "Revenue Contribution $",
                            render:
                                function (data, type, row) {
                                    return row.Amountonemonthago.toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',');
                                }
                        },
                        {
                            "data": "Percentonemonthago", "title": "Revenue Contribution %",
                            render:
                                function (data, type, row) {
                                    return row.Percentonemonthago.toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',');
                                }
                        },
                        {
                            "data": "Amounttwomonthago", "title": "Revenue Contribution $",
                            render:
                                function (data, type, row) {
                                    return row.Amounttwomonthago.toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',');
                                }
                        },
                        {
                            "data": "Percenttwomonthago", "title": "Revenue Contribution %",
                            render:
                                function (data, type, row) {
                                    return row.Percenttwomonthago.toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',');
                                }
                        },
                        {
                            "data": "Amountthreemonthago", "title": "Revenue Contribution $",
                            render:
                                function (data, type, row) {
                                    return row.Amountthreemonthago.toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',');
                                }
                        },
                        {
                            "data": "Percentthreemonthago", "title": "Revenue Contribution %",
                            render:
                                function (data, type, row) {
                                    return row.Percentthreemonthago.toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',');
                                }
                        },
                        {
                            "data": "Amountfourmonthago", "title": "Revenue Contribution $",
                            render:
                                function (data, type, row) {
                                    return row.Amountfourmonthago.toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',');
                                }
                        },
                        {
                            "data": "Percentfourmonthago", "title": "Revenue Contribution %",
                            render:
                                function (data, type, row) {
                                    return row.Percentfourmonthago.toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',');
                                }
                        },
                        {
                            "data": "Amountfivemonthago", "title": "Revenue Contribution $",
                            render:
                                function (data, type, row) {
                                    return row.Amountfivemonthago.toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',');
                                }
                        },
                        {
                            "data": "Percentfivemonthago", "title": "Revenue Contribution %",
                            render:
                                function (data, type, row) {
                                    return row.Percentfivemonthago.toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',');
                                }
                        },
                        {
                            "data": "Amountsixmonthago", "title": "Revenue Contribution $",
                            render:
                                function (data, type, row) {
                                    return row.Amountsixmonthago.toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',');
                                }
                        },
                        {
                            "data": "Percentsixmonthago", "title": "Revenue Contribution %",
                            render:
                                function (data, type, row) {
                                    return row.Percentsixmonthago.toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',');
                                }
                        },
                        {
                            "data": "Amountsevenmonthago", "title": "Revenue Contribution $",
                            render:
                                function (data, type, row) {
                                    return row.Amountsevenmonthago.toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',');
                                }
                        },
                        {
                            "data": "Percentsevenmonthago", "title": "Revenue Contribution %",
                            render:
                                function (data, type, row) {
                                    return row.Percentsevenmonthago.toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',');
                                }
                        },
                        {
                            "data": "Amounteightmonthago", "title": "Revenue Contribution $",
                            render:
                                function (data, type, row) {
                                    return row.Amounteightmonthago.toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',');
                                }
                        },
                        {
                            "data": "Percenteightmonthago", "title": "Revenue Contribution %",
                            render:
                                function (data, type, row) {
                                    return row.Percenteightmonthago.toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',');
                                }
                        },
                        {
                            "data": "Amountninemonthago", "title": "Revenue Contribution $",
                            render:
                                function (data, type, row) {
                                    return row.Amountninemonthago.toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',');
                                }
                        },
                        {
                            "data": "Percentninemonthago", "title": "Revenue Contribution %",
                            render:
                                function (data, type, row) {
                                    return row.Percentninemonthago.toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',');
                                }
                        },
                        {
                            "data": "Amounttenmonthago", "title": "Revenue Contribution $",
                            render:
                                function (data, type, row) {
                                    return row.Amounttenmonthago.toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',');
                                }
                        },
                        {
                            "data": "Percenttenmonthago", "title": "Revenue Contribution %",
                            render:
                                function (data, type, row) {
                                    return row.Percenttenmonthago.toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',');
                                }
                        },
                        {
                            "data": "Amountelevenmonthago", "title": "Revenue Contribution $",
                            render:
                                function (data, type, row) {
                                    return row.Amountelevenmonthago.toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',');
                                }
                        },
                        {
                            "data": "Percentelevenmonthago", "title": "Revenue Contribution %",
                            render:
                                function (data, type, row) {
                                    return row.Percentelevenmonthago.toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',');
                                }
                        },
                        {
                            "data": "Amounttwelvemonthago", "title": "Revenue Contribution $",
                            render:
                                function (data, type, row) {
                                    return row.Amounttwelvemonthago.toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',');
                                }
                        },
                        {
                            "data": "Percenttwelvemonthago", "title": "Revenue Contribution %",
                            render:
                                function (data, type, row) {
                                    return row.Percenttwelvemonthago.toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',');
                                }
                        },
                    ];

                    var objPreviousMonths = data.objPreviousMonths;
                    for (var month in objPreviousMonths) {
                        $('#' + month).text(objPreviousMonths[month]);
                    }

                    var dtSuiteTable = $('#table-projectrevenue').DataTable({
                        scrollResize: true,
                        scrollY: 500,
                        scrollX: 500,
                        responsive: false,
                        data: data.arrDataConsolidated,
                        columns: arrColumnsKey,
                        pageLength: 25,
                        // columnDefs: arrDefs,
                        buttons: [
                            'pageLength',
                            'copy',
                            'excel',
                            'csv',
                            'pdf'
                        ],
                        bFilter: true,
                        rowGroup: {
                            endRender: function (rows, group) {
                                var rowSubtotal = $('<tr style="background-color:#337ab7!important"/>')
                                    .append('<td style="text-align:left;background-color:#337ab7!important;color:#FFF" >SubTotal:</td>')
                                    .append('<td style="text-align:left;background-color:#337ab7!important;color:#FFF"></td>');

                                for (var indx = 2; indx < arrColumnsKey.length; indx++) {
                                    var indxColumn = arrColumnsKey[indx].data;

                                    for (var indxRow = 0; indxRow < rows.data().length; indxRow++) {
                                        var inTotal = rows.data().reduce(function (a, b) {
                                            var subtotal = a + b[indxColumn];

                                            return Number(subtotal);
                                        }, 0);
                                    }

                                    rowSubtotal.append('<td style="text-align:left;background-color:#337ab7!important;color:#FFF">' + inTotal.toLocaleString(undefined, {minimumFractionDigits: 2}) + '</td>');
                                }

                                return rowSubtotal;
                            },
                            dataSrc: "Project"
                        },

                        footerCallback: function (row, data, start, end, display) {
                            var api = this.api();

                            // Remove the formatting to get integer data for summation
                            var intVal = function (i) {
                                return typeof i === 'string' ?
                                    i.replace(/[\$,]/g, '') * 1 :
                                    typeof i === 'number' ?
                                        i : 0;
                            };


                            for (var nLine = 2; nLine < 26; nLine++) {

                                var monthAmount = api
                                    .column(nLine, {page: 'all'})
                                    .data()
                                    .reduce(function (a, b) {
                                        return intVal(a) + intVal(b);
                                    }, 0);

                                $(api.column(nLine).footer()).html(monthAmount.toLocaleString(undefined, {minimumFractionDigits: 2}));
                            }
                        }
                    });

                    window.loaded = true;

                },
                'json'
            ).fail(function (xhr, status, error) {
                console.log("An AJAX error occured: " + status + "\nError: " + error);
            });

        });
    </script>
</head>
<body>
<div class="loader"></div>
<table id="table-projectrevenue" class="table table-striped" style="width:100%">
    <thead>
    <tr>
        <th rowspan="2" style="vertical-align: middle">Project</th>
        <th rowspan="2" style="vertical-align: middle">Employee</th>
        <th colspan="2" style="text-align: center; font-weight: bold"><p id="dtMonth1"></p></th>
        <th colspan="2" style="text-align: center; font-weight: bold"><p id="dtMonth2"></p></th>
        <th colspan="2" style="text-align: center; font-weight: bold"><p id="dtMonth3"></p></th>
        <th colspan="2" style="text-align: center; font-weight: bold"><p id="dtMonth4"></p></th>
        <th colspan="2" style="text-align: center; font-weight: bold"><p id="dtMonth5"></p></th>
        <th colspan="2" style="text-align: center; font-weight: bold"><p id="dtMonth6"></p></th>
        <th colspan="2" style="text-align: center; font-weight: bold"><p id="dtMonth7"></p></th>
        <th colspan="2" style="text-align: center; font-weight: bold"><p id="dtMonth8"></p></th>
        <th colspan="2" style="text-align: center; font-weight: bold"><p id="dtMonth9"></p></th>
        <th colspan="2" style="text-align: center; font-weight: bold"><p id="dtMonth10"></p></th>
        <th colspan="2" style="text-align: center; font-weight: bold"><p id="dtMonth11"></p></th>
        <th colspan="2" style="text-align: center; font-weight: bold"><p id="dtMonth12"></p></th>
    </tr>
    <tr>
        <th></th>
        <th></th>
        <th></th>
        <th></th>
        <th></th>
        <th></th>
        <th></th>
        <th></th>
        <th></th>
        <th></th>
        <th></th>
        <th></th>
        <th></th>
        <th></th>
        <th></th>
        <th></th>
        <th></th>
        <th></th>
        <th></th>
        <th></th>
        <th></th>
        <th></th>
        <th></th>
        <th></th>
    </tr>
    </thead>
    <tfoot>
    <tr>
        <th colspan="2" style="text-align:left; font-weight: bold">Total:</th>
        <th style="text-align:left; font-weight: bold"></th>
        <th style="text-align:left; font-weight: bold"></th>
        <th style="text-align:left; font-weight: bold"></th>
        <th style="text-align:left; font-weight: bold"></th>
        <th style="text-align:left; font-weight: bold"></th>
        <th style="text-align:left; font-weight: bold"></th>
        <th style="text-align:left; font-weight: bold"></th>
        <th style="text-align:left; font-weight: bold"></th>
        <th style="text-align:left; font-weight: bold"></th>
        <th style="text-align:left; font-weight: bold"></th>
        <th style="text-align:left; font-weight: bold"></th>
        <th style="text-align:left; font-weight: bold"></th>
        <th style="text-align:left; font-weight: bold"></th>
        <th style="text-align:left; font-weight: bold"></th>
        <th style="text-align:left; font-weight: bold"></th>
        <th style="text-align:left; font-weight: bold"></th>
        <th style="text-align:left; font-weight: bold"></th>
        <th style="text-align:left; font-weight: bold"></th>
        <th style="text-align:left; font-weight: bold"></th>
        <th style="text-align:left; font-weight: bold"></th>
        <th style="text-align:left; font-weight: bold"></th>
        <th style="text-align:left; font-weight: bold"></th>
        <th style="text-align:left; font-weight: bold"></th>
        <th style="text-align:left; font-weight: bold"></th>
    </tr>
    </tfoot>
</table>
</body>
</html>